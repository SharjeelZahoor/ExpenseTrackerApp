{% extends 'main.html' %}
{% load static %}

{% block content %}
  <div class="container mt-5">
    <h2 class="mb-4">Dashboard</h2>


<div style="
  display: flex; 
  gap: 20px; 
  justify-content: center; 
  margin: 20px; 
  flex-wrap: wrap;
">
  <div style="
    flex: 1 1 280px; 
    max-width: 300px;
    background: linear-gradient(135deg, #28a745, #218838);
    color: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    padding: 24px 32px;
    text-align: center;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: 700;
    cursor: default;
    transition: transform 0.3s, box-shadow 0.3s;
  "
  onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 24px rgba(0,0,0,0.2)';"
  onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';"
  >
    <h5 style="margin-bottom: 12px; color:white; font-size: 1.4rem; letter-spacing: 1.2px; text-transform: uppercase;">
      Total Income of THIS Month
    </h5>
    <p style="font-size: 1.8rem; color:white; font-weight: 800; margin: 0;">
      <span style="color: #ffe066;">PKR</span>{{ income }}
    </p>
  </div>

  <div style="
    flex: 1 1 280px; 
    max-width: 300px;
    background: linear-gradient(135deg, #dc3545, #c82333);
    color: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    padding: 24px 32px;
    text-align: center;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: 700;
    cursor: default;
    transition: transform 0.3s, box-shadow 0.3s;
  "
  onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 24px rgba(0,0,0,0.2)';"
  onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';"
  >
    <h5 style="margin-bottom: 12px; color:white; font-size: 1.4rem; letter-spacing: 1.2px; text-transform: uppercase;">
      Total Expenses of This Month
    </h5>
    <p style="font-size: 1.8rem; color:white; font-weight: 800; margin: 0;">
     <span style="color: #ffe066;">PKR</span>{{ expense }}
    </p>
  </div>

  <div style="
    flex: 1 1 280px; 
    max-width: 300px;
    background: linear-gradient(135deg, #17a2b8, #138496);
    color: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    padding: 24px 32px;
    padding-top: 50px;
    text-align: center;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: 700;
    cursor: default;
    transition: transform 0.3s, box-shadow 0.3s;
  "
  onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 8px 24px rgba(0,0,0,0.2)';"
  onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.1)';"
  >
    <h5 style="margin-bottom: 12px; color:white; font-size: 1.4rem; letter-spacing: 1.2px; text-transform: uppercase;">
      Balance
    </h5>
    <p style="font-size: 1.8rem; color:white; font-weight: 800; margin: 0;">
      <span style="color: #ffe066;">PKR</span>{{ balance }}
    </p>
  </div>
</div>


  <div style="text-align: center;">
    <h4 style="
      margin-top: 1.5rem; /* approximate mt-4 spacing */
      color: #2f7a2f;
      padding: 8px 16px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-weight: 800;
      font-size: 1.75rem;
      letter-spacing: 0.8px;
      user-select: none;
      display: inline-block;
    ">
      Monthly Budget Progress
    </h4>
  </div>
    {% for bp in budget_progress %}
      <div class="mb-3" style="padding: 10px;">
        <strong>{{ bp.category }}</strong>: Rs. {{ bp.spent }} of Rs. {{ bp.amount }} ({{ bp.percent_used }}%)
        <div class="progress">
          <div class="progress-bar 
          {% if bp.percent_used >= 100 %}
              
              
            bg-danger


            {% elif bp.percent_used >= 80 %}
              
              
            bg-warning


            {% else %}
              
              
            bg-success


            {% endif %}
            role="progressbar"
            style="width: {{ bp.percent_used }}%;"
            aria-valuenow="{{ bp.percent_used }}
            aria-valuemin="0"
            aria-valuemax="100">{{ bp.percent_used }}%</div>
        </div>
      </div>
{% if bp.percent_used >= 100 %}
  <h2 style="
    max-width: 320px;
    margin: 20px auto;
    padding: 30px 20px;
    color: #000000;
    background-color: #ffcccb;
    border-radius: 12px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: 700;
    font-size: 1.6rem;
    text-align: center;
    box-shadow: 0 4px 8px rgba(255, 99, 71, 0.3);
    user-select: none;
  ">
    Stop! Budget Exhausted
  </h2>
  {% elif bp.percent_used >= 80 %}
  <h2 style="
    max-width: 320px;
    margin: 20px auto;
    padding: 30px 20px;
    color: #000000;
    background-color: #ffffe0;
    border-radius: 12px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-weight: 700;
    font-size: 1.6rem;
    text-align: center;
    box-shadow: 0 4px 8px rgba(255, 223, 86, 0.3);
    user-select: none;
  ">
    Warning: 80% Budget Used
  </h2>
{% endif %}

    {% empty %}
      <p>No budgets set for this month.</p>
    {% endfor %}

    <!-- Recent Transactions -->
      <div style="text-align: center;">
    <h4 style="
      margin-top: 1.5rem; /* approximate mt-4 spacing */
      margin-bottom: 0.5rem;
      color: #2f7a2f;
      padding: 8px 16px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-weight: 800;
      font-size: 1.75rem;
      letter-spacing: 0.8px;
      user-select: none;
      display: inline-block;
    ">
      Recent Transactions
    </h4>
  </div>
    <ul class="list-group mb-4">
      {% for tx in transactions %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            {{ tx.date }} - <strong>{{ tx.category.name }}</strong> ({{ tx.type }})
          </div>
          <span class="badge bg-primary rounded-pill">PKR {{ tx.amount }}</span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">No transactions found.</li>
      {% endfor %}
    </ul>

    <!-- Monthly Budgets -->
      <div style="text-align: center;">
    <h4 style="
      margin-top: 1.5rem; /* approximate mt-4 spacing */
      margin-bottom: 0.5rem;
      color: #2f7a2f;
      padding: 8px 16px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-weight: 800;
      font-size: 1.75rem;
      letter-spacing: 0.8px;
      user-select: none;
      display: inline-block;
    ">
      This Month Budget
    </h4>
  </div>
    <ul class="list-group mb-4">
      {% for b in budgets %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>{{ b.category.name }}</span>
          <span class="badge bg-warning text-dark rounded-pill">PKR {{ b.amount }}</span>
        </li>
      {% empty %}
        <li class="list-group-item text-muted">No budget set for this month.</li>
      {% endfor %}
    </ul>



</div>
{% endblock %}


